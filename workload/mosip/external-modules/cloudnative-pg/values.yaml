pg_db_user: mosippdb
pg_db_password: <path:ocivault#mosip_pg_password#latest | base64decode> 

cluster:
  version:
    postgresql: "14"
  cluster:
    instances: 3
    storage:
      size: 8Gi
      storageClass: "longhorn"
    walStorage:
      enabled: false
      size: 1Gi
      storageClass: "longhorn"
    postgresql:
      # -- PostgreSQL configuration options (postgresql.conf)
      parameters:
        max_connections: "1000"
        wal_level: logical
        max_wal_senders: "20"
        max_replication_slots: "10"
      # -- PostgreSQL Host Based Authentication rules (lines to be appended to the pg_hba.conf file)
      pg_hba: 
        - host all all 10.244.0.0/16 md5
      # -- PostgreSQL User Name Maps rules (lines to be appended to the pg_ident.conf file)
      pg_ident: 
        - mymap   /^(.*)@mydomain\.com$      \1
    initdb: 
      database: mosippdb
      owner: mosippdb
      secret:
        name: "postgres-postgresql" 
      postInitSQL:
        - CREATE ROLE bn_keycloak WITH LOGIN NOSUPERUSER CREATEDB CREATEROLE INHERIT REPLICATION CONNECTION LIMIT -1 PASSWORD '<path:ocivault#mosip_pg_password#latest | base64decode>';
        - CREATE DATABASE bitnami_keycloak WITH OWNER = bn_keycloak TEMPLATE = template0 ENCODING = 'UTF8' TABLESPACE = pg_default CONNECTION LIMIT = -1;

